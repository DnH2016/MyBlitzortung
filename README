********************************  M y B l i t z o r t u n g  ********************************by Tobias Volgnandt with big thanks to Edmund, ke2705 and Ingmar!MyBlitzortung (MyBo) is a tool for participants of the lightning detection network blitzortung.org, not only to display lightning data on their web sites. Look at http://www.wetter-rosstal.de/myblitzortung (german!) for further information and a demonstration.-------LICENSE-------GNU General Public License v3See license.txt!This program and this documentation is distributed WITHOUT ANY WARRANTY!------------REQUIREMENTS------------- Apache web server (other web servers untestet)- MySQL 5 (Version 4 untestet)- PHP 5 (it won't work with PHP4!)- about 100 MB of free memory for database and cache files (and much more if you want to archive all data)-------SUPPORT-------See this thread:http://www.wetter-board.de/index.php?page=Thread&threadID=47554Of course, you can ask questions there in english. It would also be great to hear of successful installations.-------HELPING-------EVERYBODY CAN HELP BY SUPPORTING OTHER USERS AND BY DEVELOPING THIS PROGRAM!- Adding new translations- Improve and add features- Find AND report bugs- Support other users------------INSTALLATION------------== 1. Get the files ==Download the archive from:--> https://github.com/tobiasv/MyBlitzortungOf course, you can also pull it from git.== 2. Copy the files ==Copy the files from the archive to your webserver (usually with FTP).For example, we use the directory "mybo" here, or in the browser "http://yourdomain.tld/mybo".== 3. Call the installation script ==Call "http://yourdomain.tld/mybo/install". The installer will guide you through the installation process. The hardest thing is to create your own "config.php". The database will be installed automatically.== 4. Change permission of the cache directories ==Change permissions of the directories, so that the web server can write in it. Usually the permissions are set to "777".- cache- cache/tiles- cache/maps- cache/icons== 5. Setup data import ==Now you have to set up the automatic data import. The link for that is displayed in the last step of the installation process. You can create an own cron entry, or an entry in the windows tasks. The easiest way is to use an external provider like http://cronjob.deUpdate frequency: You can call the URL every minute. There is an internal timer, that prevents accessing the files on the blitzortung server to much. Default settings for this timer for strike updates is 5 Minutes, for stations 15 and for signals 60. You can change these values in settings.php.== 6. Configuration ==The essential configuration was already done in config.php. But there are a lot of other settings, that you can change individually. The file for that is settings.php. See next chapter for more details.== 7. Install JpGraph ==JpGraph is used for creating the graphs. You can get it at http://jpgraph.net/download/ . Copy the files from the JpGraph "src" direcory to includes/jpgraph. You can omit the directories src/barcode, src/Examples, src/themes and all files beginnig width <em>flag</em>. No further installation is needed!== 8. Check if everything works ==Call http://yourdomain.tld/mybo and you should see the map. You can now login with your blitzortung username and password.Please follow with step 1 of the next chapter.-------------CONFIGURATION-------------All configuration options can be set in the file settings.php !There are a lot of more configuration options, than described here. Please see settings.php for more info. Most of them are self-explanatory.== Constants ==A note on defining constants. Example:################################################define(BO_CONSTANT, "Test value");################################################Sets BO_CONSTANT to the string "Test value". Sometimes you need to enter false or true. Don't use quotes with them!!! ################################################define(BO_CONSTANT, "true");  //NOT CORRECTdefine(BO_CONSTANT, "false"); //NOT CORRECTdefine(BO_CONSTANT, true);    //Good!define(BO_CONSTANT, false);   //Good!################################################== 1. Set up data purging ==The size of the database may grow VERY fast. For that, an automatic data purging is integrated. * BO_PURGE_ENABLE: Enables/Disables data purging completly (it is not advised to set it to "false").* BO_PURGE_MAIN_INTVL: The main interval (in hours) for data purging.With the other constants BO_PURGE... you can individually set up purging by specifying a minimum before old data will be deleted. See settings.php for all available constants. The following two settings should be enabled:* BO_PURGE_STRSTA_ALL: Deletes the assignments for strikes to every stations (your station is saved elsewhere). This data grows VERY fast! You can set it to 24 hours or less.* BO_PURGE_SIG_NS: Your signal (raw) data. Can also get very big, especially if your station sends much signals per hour.== 2. Radius and zoom levels ==* With BO_RADIUS you set the maximum radius around your station, where guests can see all strikes on every zoom level.== 3. Main Map ==The main map (Google map) is configured with by the array $_BO['mapcfg']. Every time range has its own array:$_BO['mapcfg'][0] ... for the first (0-15min)$_BO['mapcfg'][1] ... for the second (15-120min)$_BO['mapcfg'][2] ... for the third (2-24h)You can add or change this array individually (see the examples in settings.php).After changing these settings you should clear the files in the cache/maps directory. When developing, you should set BO_CACHE_DISABLE to true!== 4. Maps as Images ==It works almost the same way like above, but the var is now $_BO['mapimg']. You can create as much maps as you want. Call them with blitzortung.php?map=X (where X is the map no) or call the HTML site where the map is embedded with blitzortung.php?bo_showmap=X .-------------------WEBSITE INTEGRATION-------------------MyBlitzortung was designed to be included seamlessly in your own homepage. No Javascript in the body or somewhere else is needed, only two or more lines with PHP code. Of course, you need some basic PHP experience for that. For a first example you should look in the file index.php in the MyBlitzortung root directory.Here's an example of integrating the main map into a web page:####################################################<html>....HTML or PHP code....<?phpinclude ‘path/to/myblitzortung/blitzortung.php’;bo_show_map();?>...</html>####################################################(See next chapter for available functions.)Two important things:1. MyBo needs know, where the "blitzortung.php" resides. Set the constant BO_FILE to the URL to this file.2. Same thing with the login. As you can integrate the login-screen in a site of your own with the function bo_show_login(), MyBo needs to know the URL to that site. Set it with BO_LOGIN_FILE in settings.php.---------FUNCTIONS---------== bo_show_map() ==Shows the main map.== bo_show_archive() ==The Archive.== bo_show_statistics() ==Statistics and graphs.== bo_show_info() ==General and additional information.== bo_show_login() ==Login screen and user area.The following function includes all functions above.== bo_show_all() ==Shows one of the five areas from above, according to the GET-Variable "bo_page". The bo_page can be one of the following values: map, archive, statistics, info, login== bo_show_menu() ==Shows the main menu. For usage with bo_show_all().-------------STRIKE ALERTS-------------You can define strike alerts. MyBlitzortung will automatically send an E-Mail or SMS when strikes in an area occur.== SMS configuration ==First you need to register at an SMS-gateway. Some examples:- smstrade.de- sms77.de- innosend.deI prefer smstrade.de but the others should also work. You will get a username/password and perhaps an individual key for usage with their API. You have to set the constant BO_SMS_GATEWAY_URL correctly. {text} and {tel} are placeholders for text an the phone number. Example:  http://gateway.smstrade.de/?key=1234567891234566&to={tel}&message={text}&from=MyBO&route=gold   -------------------ANTENNA CALIBRATION-------------------This works only with magnetic antennas, but it works very well if enough strikes and signals where recorded. Finding the electrcal directions ist VERY experimental! You can test For further informations please ask on wetter-board.de (see link in Chapter "Support"). -----F A Q-----== 1. Nothing works ==Set BO_DEBUG in the settings.php file to true an look for error messages. Double check you installation and try to reinstall MyBo.A common failure: Wrong text mode. Use the correct text mode of your PHP installation, in 99.9% this is linux text mode. You can convert it with free editors like Notepad++. Or use WinSCP to access your web server per FTP. Don't access your FTP with Internet Explorer!== 2. Update shows "NO UPDATE!" ==This is ok! It is the integrated timer.== 3. Antialiasing Graphs ==JpGraphs default setting use antialiasing images. This looks nice, but takes much more CPU usage and thick lines are not available. Some PHP installations don't have the required builtin GD-lib. It is disabled by default (BO_GRAPH_ANTIALIAS set to false).== 4. My CPU load gets very high ==One reason could be the calculating of statistics of other stations during import. You can disable this by setting BO_STATION_STAT_DISABLE to true.The creation and downloading of the map tiles can cause VERY high CPU load. If you have a temporarily high visitor count on your website, you could disable the Google map, by setting BO_MAP_DISABLE to true. ------------MISCANELLOUS------------== 1. Changing one or more texts or messages ==Create file "locales/own.php" and enter your own messages. See "own_example.php" for more details.DON'T edit the other locales like en.php , because they will be overwritten on each update!== 2. See strike details ==When logged in, right click on a strike on the main map to open a new window with further information. Works only on higher zoom levels.